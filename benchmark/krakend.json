{
  "$schema": "https://www.krakend.io/schema/v3.json",
  "version": 3,
  "port": 8080,
  "timeout": "10s",
  "cache_ttl": "300s",
  "endpoints": [
    {
      "endpoint": "/bench/plain",
      "method": "GET",
      "output_encoding": "no-op",
      "backend": [
        {
          "url_pattern": "/",
          "encoding": "no-op",
          "host": ["http://echo:3000"]
        }
      ]
    },
    {
      "endpoint": "/bench/auth",
      "method": "GET",
      "output_encoding": "no-op",
      "extra_config": {
        "security/policies": {
          "req": {
            "check_expr": "len(req_headers['Apikey']) > 0 && req_headers['Apikey'][0] == 'bench-secret-key'"
          },
          "error": {
            "body": "{\"error\": \"Unauthorized\"}",
            "status": 401,
            "content_type": "application/json"
          }
        }
      },
      "backend": [
        {
          "url_pattern": "/",
          "encoding": "no-op",
          "host": ["http://echo:3000"]
        }
      ]
    }
  ]
}
